<!DOCTYPE html>
<html>
  <head>
    <title>DVL cache test</title>
    <link type="text/css"         href="base/css/smoothness/jquery-ui-1.8.7.custom.css" rel="Stylesheet" />	
    <script type="text/javascript" src="base/js/jquery-1.6.2.min.js"></script>
    <script type="text/javascript" src="base/js/jquery-ui-1.8.7.custom.js"></script>
    <script type="text/javascript" src="base/d3.js"></script>
    <script type="text/javascript" src="base/protovis-r3.2.js"></script>
    <script type="text/javascript" src="base/sprintf.js"></script>
    <script type="text/javascript" src="base/dvl.js"></script>

  </head>
  <body>
  </body>
  <script type="text/javascript">
  
  var v = dvl.def(100, 'value1');
  
  var url1 = dvl.apply({ args:v, fn:function(v) { return 'http://localhost:8900/?expr=' + v + '&sleep=2000'; } });
  var url2 = dvl.apply({ args:v, fn:function(v) { return 'http://localhost:8900/?expr=' + v + '&sleep=2000'; } });
  
  var groupId = dvl.ajax.getGroupId();
  var method = 'GET';
  var requester = dvl.ajax.requester.cache();
  
  var ret1 = dvl.ajax({ url:url1, type:'json', groupId:groupId, method:method, requester: requester });
  var ret2 = dvl.ajax({ url:url2, type:'json', groupId:groupId, method:method, requester: requester });
  
  dvl.debug("Return 1", ret1);
  dvl.debug("Return 2", ret2);
  
  // var ret1 = dvl.ajax({ url:url1, type:'json', method:method, requester: requester });
  // dvl.debug("URL 1", url1);
  // dvl.debug("Return 1", ret1);
  // 
  // setTimeout("v.update(105)", 900);
  // setTimeout("v.update(100)", 3000);
  
  
  // setTimeout("v.update(200)", 10000);
  // setTimeout("v.update(100)", 14000);
  
  dvl.debug(dvl.json.outstanding);
  
  </script>
</html>
